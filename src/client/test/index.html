<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">


	<style>
		body{
			font-size: 0.7rem;
		}

		.out-bracket-wrapper{
			/*border: 3px solid beige;*/
    		margin: 0;
		}	
		
		.left{
			/*border: 1px solid pink;*/
		}

		.ob-top{
			margin-bottom: 10px;
		}

		.ob-bottom{
			margin-top: 10px;
		}


		.ob-left, .ob-right{
		/*	width: 50%;*/
			/*border: 1px solid #eee;*/
		}	

		.ob-right{
			align-self: center;
		}

		.ob-right.top, .ob-right.bottom{
			/*border: 1px solid gold;*/
			height: 50%;
			width: 100%;
		}

		.ob-right.top, .ob-right.bottom{
			display: flex;
		}

		.ob-right .single-bracket {
			align-self: center;
			/*border: 1px solid #ccc;*/
		}

		.paired-bracket {
		    /*margin: 25px 0;*/
		}

		.single-bracket{
			width: 100%;
		}

		input{
			max-width: 80%;
			max-height: 15px;
			border-style: none;
			border-bottom: 1px solid #ccc;
			margin-top: 5px;
		}

		button{
			width: 15%;
			font-size: 50%;
			vertical-align: text-bottom;
			cursor: pointer;
		}

	</style>
</head>
<body>
	<p>Outer Bracket</p>

<!-- 	<div class="final-bracket-wrapper col">
		<div class="final-left col">

			<div class="out-bracket-wrapper row">
				<div class="ob-left">
					<div class="ob-top left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="One">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
					<div class="ob-bottom left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="Two">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
				</div>
				<div class="ob-right">
					<div class="ob-right top">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>

					<div class="ob-right bottom">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>
				</div>
			</div>


			<div class="out-bracket-wrapper row">
				<div class="ob-left">
					<div class="ob-top left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="One">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
					<div class="ob-bottom left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="Two">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
				</div>
				<div class="ob-right">
					<div class="ob-right top">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>

					<div class="ob-right bottom">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>
				</div>
			</div>

		</div>

		<div class="final-right col">
			<div class="single-bracket">
				<input type="text" value="One">
			</div>
		</div>
		
	</div>

		<div class="final-bracket-wrapper col">
		<div class="final-left col">

			<div class="out-bracket-wrapper row">
				<div class="ob-left">
					<div class="ob-top left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="One">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
					<div class="ob-bottom left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="Two">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
				</div>
				<div class="ob-right">
					<div class="ob-right top">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>

					<div class="ob-right bottom">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>
				</div>
			</div>


			<div class="out-bracket-wrapper row">
				<div class="ob-left">
					<div class="ob-top left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="One">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
					<div class="ob-bottom left">
						<div class="paired-bracket">
							<div class="single-bracket">
								<input type="text" value="Two">
								<button>=></button>	
							</div>
							<div class="single-bracket">
								<input type="text" value="Buy">
								<button>=></button>	
							</div>
						</div>
					</div>
				</div>
				<div class="ob-right">
					<div class="ob-right top">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>

					<div class="ob-right bottom">
						<div class="single-bracket">
							<input type="text" placeholder="TBD">
							<button>=></button>	
						</div>
					</div>
				</div>
			</div>

		</div>

		<div class="final-right col">
			<div class="single-bracket">
				<input type="text" value="One">
			</div>
		</div> -->
		
	</div>
	<script>
		


// Execute all functions below and return ordered array for Tourney Brackets
 const createCompetitorPairs = (participantsArr) => {

	let numOfBrackets = bracketGenerator(bracketArr, participantsArr.length);
	let numOfByes = getByes(participantsArr.length, numOfBrackets);
	let matchedList = matchParticipants(participantsArr, numOfByes);
	console.log('Matched: ', matchedList)
	return matchedList;

}

// Array of available brackets
 const bracketArr = [4,8,16,32,64];

// Function to find correct bracket
// Call function with bracketArr (arr) and number of participants (participants)
// Utilizing a binary search algorithm (of sorts)

// Generate random seeding
 const ranSeeding = (arr) => {
	let ranArray = [];
	let ranIndex = 0;
	let len = arr.length;

	while(len > 0){
		ranIndex = Math.floor(Math.random() * arr.length);
		ranArray.push(arr.splice(ranIndex,1)[0]);
		len = arr.length;
	}
	return ranArray;
}

// Calculates # of brackets needed.  Call this function with the bracketArr above and with the array length of participants ie.
// participants = ['Tom', 'Matt', 'Brandon', 'Dean'];
// bracketGenerator(bracketArr, participants.length); => 
 const bracketGenerator = (arr, participants, start=0, end=arr.length) => {

	// Find middle of bracketArr

	const index = Math.floor((start + end) / 2);

	// Get/store value from the center of the array

	const bracketNum = arr[index];

	// Check if the match and return

	if(bracketNum === participants){
		return bracketNum;
	}

	// If that middle value is higher than # of participants and prev value is lower
	// than that is the correct bracket #

	else if(bracketNum > participants && bracketArr[index - 1] < participants){
		return bracketNum;
	} 

	// If the value is too high then recursivley call the function with 
	// recalculated starting/ending points of the array

	else if(bracketNum > participants && bracketArr[index - 1] >= participants){
		return bracketGenerator(arr, participants, start, index-1);
	}

	// If the value is too low then recursivley call the function with 
	// recalculated starting/ending points of the array

	else if(bracketNum < participants){
		return bracketGenerator(arr, participants, index+1, end);
	}
}

// Calculate # of byes needed for tournament
// Call getbyes with number of participants and number of brackets (which should come from the bracketGenerator function) ie.
// participants = ['Tom', 'Matt', 'Brandon', 'Dean', 'Jose'];
// getbyes(participants.length, 8)
 const getByes = (numParticipants, numBrackets) => {
	return numBrackets - numParticipants;
}

// Matches the participants with correct buy or other participant.  This will return a 2D array with pairs inside each inner array.
// Call function with the array of participants and # of byes (which should come from getbyes function) ie.
// participants = ['Tom', 'Matt', 'Brandon', 'Dean', 'Jose'];
// matchParticipants(participants, 3);
 const matchParticipants = (participants, numOfbyes) => {
	// 2D Array to hold pairs of opponents
	let brackets = [];

	// Usurp all byes on top seeded participants and push into brackets array
	for(let i = 0; i < numOfbyes; i++){
		let matchUp = participants.splice(0,1);
		matchUp.push('Buy');
		brackets.push(matchUp);
	}
	// Match up rest of participants against each other
	while(participants.length > 0){
		let matchUp2 = participants.splice(0,1);
		let last = participants.splice(participants.length - 1)[0]
		matchUp2.push(last);
		brackets.push(matchUp2);
	}
	
	// Reorder brackets
	let orderedBrackets = [];

	orderedBrackets.push(brackets.splice(0,1));
	orderedBrackets.push(brackets.splice(brackets.length - 1, 1))

	while(brackets.length > 0){

		let mid = Math.ceil((brackets.length / 2));
		let index = mid === 0 ? 0 : (mid - 1)
		orderedBrackets.push(brackets.splice(index,1));
		console.log(brackets)
	}
	return orderedBrackets;
}




// Create Component
const createBracketInputs = (competitors) => {
	const bracket = document.createElement('div');
	bracket.classList = 'brackets-wrapper';

	competitors.forEach(el => {
		let pairedBracket = createPairedBrackets(el);
		bracket.appendChild(pairedBracket);
	});

	document.body.appendChild(bracket);
}

// Create Single Bracket
const createSingleBracket = (competitor) => {
	const singleBracket = document.createElement('div');
	singleBracket.classList = 'single-bracket';

	const input = document.createElement('input');
	const btn = document.createElement('button');
	input.value = competitor;
	btn.innerText = '=>';
	singleBracket.appendChild(input);
	singleBracket.appendChild(btn);

	return singleBracket;
}

// Create Paired Brackets
const createPairedBrackets = (competitorPairs) => {
	let singleBracketArray = [];
	let pairedBracketsArray = [];

	competitorPairs.toString().split(',').forEach((el) => {
		let singleBracket = createSingleBracket(el);

		singleBracketArray.push(singleBracket);
	});

	for(let i = 0; i < singleBracketArray.length; i = i + 2){
		let pairedBracket = document.createElement('div');
		pairedBracket.classList = 'paired-bracket';
		
		pairedBracket.appendChild(singleBracketArray[i]);
		pairedBracket.appendChild(singleBracketArray[i + 1]);
		
		pairedBracketsArray.push(pairedBracket);

	}
	return pairedBracketsArray;
}

// Create Outer Brackets
const createOuterBrackets = (pairedBrackets) => { 
	const outerBracketArr = [];

	for(let i = 0; i < pairedBrackets.length; i = i + 2){
		// Create Outer Bracket Container
		const outerBracket = document.createElement('div');
		outerBracket.classList = 'out-bracket-wrapper row'

		// Create 2 sections of Outer Bracket (right/left)
		const obLeft = document.createElement('div');
		obLeft.classList = 'ob-left';
		
		const obRight = document.createElement('div');
		obRight.classList = 'ob-right';

		// Create 2 sections for each left/right section (top/bottom)
		const obTopLeft = document.createElement('div');
		obTopLeft.classList = 'ob-top left';

		// Fill in sections with paired brackets
		const obBottomLeft = document.createElement('div');
		obBottomLeft.classList = 'ob-bottom left';

		const obTopRight = document.createElement('div');
		obTopRight.classList = 'ob-right top';

		const obBottomRight = document.createElement('div');
		obBottomRight.classList = 'ob-right bottom';

		obTopLeft.appendChild(pairedBrackets[i]);
		obBottomLeft.appendChild(pairedBrackets[i + 1]);

		// Fill in right side outer bracket with single brackets
		const singleBracket1 = createSingleBracket('');
		const singleBracket2 = createSingleBracket('');

		// Attach children to parents
		obTopRight.appendChild(singleBracket1);
		obBottomRight.appendChild(singleBracket2);

		obRight.appendChild(obTopRight);
		obRight.appendChild(obBottomRight);

		obLeft.appendChild(obTopLeft);
		obLeft.appendChild(obBottomLeft);

		outerBracket.appendChild(obLeft);
		outerBracket.appendChild(obRight);

		outerBracketArr.push(outerBracket);
	}

	return outerBracketArr;
}

// Wrapp all Outer Brackets within other Outer Brackets
const createAllOuterBrackets = (outerBrackets) => {
	let totalBrackets = outerBrackets;
	
	while(totalBrackets.length !== 2) {
		totalBrackets = createOuterBrackets(totalBrackets);
	}
	return totalBrackets;
}

// Create Final Bracket
const createFinalBracket = (allOuterBrackets) => {
	const winnerBracket = document.createElement('div');
	winnerBracket.classList = 'brackets-wrapper';

	const wbLeft = document.createElement('div');
	wbLeft.classList = 'ob-left';
	wbLeft.style.display = 'inline-block';

	const wbRight = document.createElement('div');
	wbRight.classList = 'ob-right';
	wbRight.style.display = 'inline-block';

	const singleBracket = document.createElement('input');
	singleBracket.type = 'text';
	singleBracket.classList = 'final-bracket-input';

	allOuterBrackets.forEach(bracket => {
		wbLeft.appendChild(bracket);	
	})
	
	wbRight.appendChild(singleBracket);

	winnerBracket.appendChild(wbLeft);
	winnerBracket.appendChild(wbRight);

	return winnerBracket;
}

// Execute
var participantArr = ['first', 'second', 'third', 'fourth', 'fifth']//, 'Sixth', 'Seventh', 'Eighth', 'Ninth', 'Tenth', 'Eleventh'];

var CompetitorPairs = createCompetitorPairs(participantArr);
console.log(CompetitorPairs);
var pairedBrackets = createPairedBrackets(CompetitorPairs);
var outerBrackets = createOuterBrackets(pairedBrackets);
var shellBrackets = createOuterBrackets(outerBrackets);
console.log(outerBrackets);
console.log(shellBrackets);
var total = createAllOuterBrackets(outerBrackets)
var winner = createFinalBracket(total);
document.body.appendChild(winner);
	


	</script>
</body>
</html>